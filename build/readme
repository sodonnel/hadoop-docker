To build the image:

docker image build -t hdfs-build-test:1.0 .

To run the compile:

docker run -it -v `pwd`/../../upstream_hadoop:/hadoop -v /Users/sodonnell/.m2:/mvn-repo -w /hadoop hdfs-build-test:1.0 /apache-maven-3.6.3/bin/mvn -Dmaven.repo.local=/mvn-repo/repository clean package -Pdist,native -DskipTests -Dmaven.javadoc.skip=true


Note I have mapped -v /Users/sodonnell/.m2:/mvn-repo and passed this to mvn so it uses the local m2 repo and does not need to download everything over and over:

 -Dmaven.repo.local=/mvn-repo/repository

###

-Dmaven.repo.local command line argument to change where the repository is at. In addition, according to settings.xml documentation, you can set -Dmaven.home where it looks for the settings.xml